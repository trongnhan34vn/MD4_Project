<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Đăng nhập</title>
    <link rel="stylesheet" href="fonts/themify-icons/themify-icons.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@300&family=Roboto:ital,wght@0,500;0,700;1,300&display=swap" rel="stylesheet">

    <link rel="shortcut icon" type="image/x-icon" href="https://theme.hstatic.net/200000388065/1000766714/14/logo.png?v=111"/>

<!--     <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous"> -->
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="fonts/fontawesome-free-6.2.0-web/css/all.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.2/font/bootstrap-icons.css">
    <script src="script/User.js"></script>
</head>

<body>
    <div class="app">
        <!-- Header -->
        <div class="header">
           <div class="header-navbar__contact">
            <div class="header-navbar__contact-item">
                <i class="fa-sharp fa-solid fa-house-chimney"></i>
                <a href="">Hệ thống cửa hàng</a>
            </div>
            <div class="header-navbar__contact-item">
                <i class="fa-solid fa-phone"></i>
                <a href="">Mua hàng online: 0969436769</a>
            </div>
           </div>
           <div class="header-navbar-feat">
               <div class="grid">
                   <div class="header-navbar-container">
                        <div class="header-navbar-item">
                            <div class="header-navbar__logo">
                                <a href="index.html">
                                    <img src="https://theme.hstatic.net/200000388065/1000766714/14/logo.png?v=111" alt="">
                                </a>
                            </div>
                        </div>
                        <div class="header-navbar-feature-container">
                            <div class="header-navbar-item">
                                <ul class="header-navbar__lists-item">
                                    <li class="header-nav-products-wrap">
                                        <a href=""
                                            >Sản phẩm
                                            <i
                                                class="fa-solid fa-angle-down"></i
                                        ></a>
                                        <ul class="header-nav-products-list">
                                            <li class="header-nav-products-item"><a href=""><span>Guitar</span> <i class="header-nav-icon ti-angle-right"></i></a></li>
                                            <li class="header-nav-products-item"><a href=""><span>Amplifier</span> <i class="header-nav-icon ti-angle-right"></i></a></li>
                                            <li class="header-nav-products-item"><a href=""><span>Dây đàn</span> <i class="header-nav-icon ti-angle-right"></i></a></li>
                                            <li class="header-nav-products-item"><a href=""><span>Pedals & Effect</span> <i class="header-nav-icon ti-angle-right"></i></a></li>
                                            <li class="header-nav-products-item"><a href=""><span>Phụ kiện đàn</span> <i class="header-nav-icon ti-angle-right"></i></a></li>
                                            <li class="header-nav-products-item"><a href=""><span>Pickup & EQ</span> <i class="header-nav-icon ti-angle-right"></i></a></li>
                                            <li class="header-nav-products-item"><a href=""><span>Thiết bị âm thanh & phòng thu</span> <i class="header-nav-icon ti-angle-right"></i></a></li>
                                            <li class="header-nav-products-item"><a href=""><span>Trống & bộ gõ</span> <i class="header-nav-icon ti-angle-right"></i></a></li>
                                        </ul>
                                    </li>
                                    <li><a href="">Sản phẩm mới</a></li>
                                    <li class="header-nav-products-wrap">
                                        <a href=""
                                            >Thương hiệu
                                            <i
                                                class="fa-solid fa-angle-down"></i
                                        ></a>
                                        <ul class="header-nav-products-list">
                                            <li class="header-nav-products-item"><a href=""><span>Guitar Plus</span> <i class="header-nav-icon ti-angle-right"></i></a></li>
                                            <li class="header-nav-products-item"><a href=""><span>Taylor</span> <i class="header-nav-icon ti-angle-right"></i></a></li>
                                            <li class="header-nav-products-item"><a href=""><span>Marshall</span> <i class="header-nav-icon ti-angle-right"></i></a></li>
                                            <li class="header-nav-products-item"><a href=""><span>Epiphone</span> <i class="header-nav-icon ti-angle-right"></i></a></li>
                                            <li class="header-nav-products-item"><a href=""><span>Martin Guitar</span> <i class="header-nav-icon ti-angle-right"></i></a></li>
                                            <li class="header-nav-products-item"><a href=""><span>Yamaha</span> <i class="header-nav-icon ti-angle-right"></i></a></li>
                                            <li class="header-nav-products-item"><a href=""><span>Cort</span> <i class="header-nav-icon ti-angle-right"></i></a></li>
                                            <li class="header-nav-products-item"><a href=""><span>Elixir</span> <i class="header-nav-icon ti-angle-right"></i></a></li>
                                            <li class="header-nav-products-item"><a href=""><span>Boss</span> <i class="header-nav-icon ti-angle-right"></i></a></li>
                                            <li class="header-nav-products-item"><a href=""><span>Fishman</span> <i class="header-nav-icon ti-angle-right"></i></a></li>
                                            <li class="header-nav-products-item"><a href=""><span>Orange</span> <i class="header-nav-icon ti-angle-right"></i></a></li>
                                            <li class="header-nav-products-item"><a href=""><span>Dunlop</span> <i class="header-nav-icon ti-angle-right"></i></a></li>
                                            <li class="header-nav-products-item"><a href=""><span>Presonus</span> <i class="header-nav-icon ti-angle-right"></i></a></li>
                                        </ul>
                                    </li>
                                    <li><a href="">Blog</a></li>
                                    <li>
                                        <a href=""
                                            >Giới thiệu
                                        </a>
                                    </li>
                                    <li><a href="">Liên hệ</a></li>
                                </ul>
                            </div>
                            <div class="header-navbar-item">
                                <ul class="header-navbar__features">
                                    <li class="nav-search"><span><i class="bi bi-search"></i></span>
                                        <div class="nav-search-container">
                                            <input placeholder="Tìm kiếm..." type="text">
                                            <button><i class="fa-solid fa-magnifying-glass"></i></button>
                                        </div>
                                    </li>
                                    <li class="nav-account"><span><i class="bi bi-person-circle"></i> Tài khoản</span>
                                        <!-- Regis & Login -->
                                        <div class="nav-account-container">
                                            <a href="register.html">Đăng kí</a>
                                            <a href="login.html">Đăng nhập</a>
                                        </div>
                                    </li>
                                    <li class="mini-cart-contain"><span><i class="bi bi-bag-fill"></i> Giỏ hàng</span></li>
                                </ul>
                            </div>
                        </div>
                   </div>
               </div>
           </div>
        </div>
        <div class="path">
            <div class="grid">
                <h1><a style="text-decoration: none; color: var(--primay-color)" href="index.html">Trang chủ</a> / Đăng nhập</h1>
            </div>
        </div>
        <div class="register">
            <div class="register-title">
                <h1><span>Đăng</span> nhập</h1>
            </div>
            <div class="register-form login-form">
                <div class="register-form__item">
                    <input oninput="validate()" id="email" placeholder="Email" type="email">
                    <span id="validateEmail"></span>
                </div>
                <div class="register-form__item">
                    <input oninput="validate()" id="password" placeholder="Mật khẩu" type="password">
                    <span id="validatePassword"></span>
                </div>
                <p>This site is protected by reCAPTCHA and the Google <a href="">Privacy Policy</a> and <a href="">Terms of Service</a> apply.</p>
                <div class="action-button button dark">
                    <button onclick="login()" class="btn">Đăng nhập</button>
                </div>
                <div class="register-back-index login-back-index">
                    <a href="index.html"><i class="fa-solid fa-arrow-left-long"></i><span>Quay lại trang chủ</span></a>
                    <a href="register.html"><span>Tạo tài khoản</span><i class="fa-solid fa-arrow-right-long"></i></a>
                </div>
            </div>
        </div>
        <div class="footer">
            <div class="grid">
                <div class="footer-container">
                    <div class="footer-logo">
                        <img src="https://theme.hstatic.net/200000388065/1000766714/14/logo.png?v=111" alt="">
                    </div>
                    <ul class="footer-social">
                        <li><a href=""><i class="bi bi-youtube"></i></a></li>
                        <li><a href=""><i class="bi bi-instagram"></i></a></li>
                        <li><a href=""><i class="bi bi-facebook"></i></a></li>
                        <li><a href=""><i class="bi bi-twitter"></i></a></li>
                    </ul>
                    <div class="footer-copyright">
                        <h3>© 2021 GUITARPLUS • ALL RIGHTS RESERVED</h3>
                    </div>
                    <ul class="footer-link">
                        <li><a href="">Trang chủ</a></li>
                        <li><a href="">Sản phẩm</a></li>
                        <li><a href="">Thương hiệu</a></li>
                        <li><a href="">Blog</a></li>
                        <li><a href="">Giới thiệu</a></li>
                        <li><a href="">Liên hệ</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <script>
        let email;
        let password;
        let listUser = JSON.parse(localStorage.getItem('list_user'));
        let checkValidate = false;
        let currentUser;

        if(listUser == null) {
            listUser = [];
        }

        function validate() {
            email = document.querySelector('#email').value;
            password = document.querySelector('#password').value;
        //     Kiểm tra tài khoản đã tồn tại hay chưa
            if(email.trim() == '') {
                checkValidate = false;
                document.getElementById('validateEmail').innerHTML = "Email is required!";
                return;
            } else {
                if(!validateEmail(email)) {
                    checkValidate = false;
                    document.getElementById('validateEmail').innerHTML = "Email is invalid!";
                    return;
                } else {
                    checkValidate = true;
                    document.getElementById('validateEmail').innerHTML = "";
                }
            }

            if(password.trim() == "") {
                checkValidate = false;
                document.getElementById('validatePassword').innerHTML = "Please enter the password!";
                return;
            } else {
                checkValidate = true;
                document.getElementById('validatePassword').innerHTML = "";
            }
        }


        function findByEmail() {
            for (let i = 0; i < listUser.length; i++) {
                if(listUser[i].email ==  email) {
                    return listUser[i];
                }
            }
        }

        function login() {
            if(checkValidate) {
                
                let checkExisted = false;
                    for (let i = 0; i < listUser.length; i++) {
                        if(email == listUser[i].email) {
                            checkExisted = true;
                        }
                    }
                    if(checkExisted) {
                        checkValidate = true;
                        document.getElementById('validateEmail').innerHTML = "";
                    } else {
                        checkValidate = false;
                        document.getElementById('validateEmail').innerHTML = "Account is not existed";
                    }

                //     Kiểm tra đúng mật khẩu chưa
                let checkPass = false;
                for (let i = 0; i < listUser.length; i++) {
                    if(email == listUser[i].email && password == listUser[i].password) {
                        currentUser = listUser[i];
                        // console.log(listUser[i].password, password)
                        // console.log(email, listUser[i].email)
                        checkPass = true;
                    } else {
                        if(email == listUser[i].email && password !== listUser[i].password) {
                            checkPass = false;
                            document.getElementById('validatePassword').innerHTML = "Wrong Password! Please try again!"
                            return;
                        }
                    }
                }

                if(checkPass && checkExisted) {
                    checkValidate = true;
                    document.getElementById('validatePassword').innerHTML = "";
                    // currentUser = findByEmail(email).firstName + " " + findByEmail(email).lastName;
                    localStorage.setItem("current_user", JSON.stringify(currentUser));
                    let id = findByEmail(email).id;
                    localStorage.setItem('idKey', id)
                    location.href = 'index.html';
                }
            }
        }

    //     Kiểm tra định dạng email
        function validateEmail(mail) {
            if (/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(mail)) {
                return (true);
            }
            // alert("You have entered an invalid email address!")
            return (false);
        }
    </script>
</body>

</html>